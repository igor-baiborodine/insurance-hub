# Insurance Hub System & Go Migration Analysis

## System Context

* [Diagram source PlantUML](/docs/c4-diagrams/context/insurance-hub-system-context-diagram.puml)
* [Generated diagram on www.plantuml.com](https://www.plantuml.com/plantuml/uml/ZPDFSzis4CNl_1HRdzoPsBhqr5CIHwdTsbEDfEIgWS2bY0f_sDsb77txOa69aLcbqni9BDxxOV7sFOiXwOElVdBH-hv6Q4Kw_dKs8_DwltFIzjkUaMoAWb7kRGgppfkeP-vOQk-siuTVxXQwzENbUHOC2r9UsZpeYMzotwbwnNiNEqCcW7SHvTWX998sLPKuyGYh8mi6E1s2sfcT5ZU9u2boJoPQXCT-MrKB94xnrkmopZku-RxxGLTkyj87K6983KYBuCO2DXuPkknhFBos2IoX4MGmiOPWOfRKRU-iGxw_-Rcg1ghRKMAJkt7fgKI3Ot2M4YCTd4M-snh66hYSrZiCwYxk2b7JUm_UDMYFrgDoZWQZ_JjeA0NukqzIZYNep35Wb09R9zkNdtnb92CknGlUpVoRtFx5X7hLJFVxQba-OJNmAN4kGOh6m-BJP_XjL85vp9YbOecnHc9uNByy3wP6J2QLf6T616tKfU_UD7kZBUcCRH7-qDzYU53UbH2Qe3VAYP4cKT2z1QM3g_KX822psI5iAUsHIkyC7wDjASNKCzWKGX-T7MYtAA-84SwDdx1iJTnl6iuE7_DNDZU2XJb_9iesQlxPZV6RFQo-3i_9mpxuT79I41UqYmglmi1dEMYo16l9-4WTfOp3kNQ298PSqmnGw_8DozxZ3ubUliwV_mD9ju4jkKuOf3K2DJOkOWPmLab9nISCTRAyESbbwK_dCFq0uQDFfv1tIEnOjFOQpJcDM6j2XYWVtmQbgfRepxCx7QilZ7g9oQ3AUKulnlJAm2ZXutgzM6KNzPY8Nup3AUt8_oA4NbziL9ejvwlrTRbpoXVzrZjkaGkSJP6p4cV5O5m4F1JLQOWlqd5T_NjkdqhaU1AujraZpBxMULSUOdoz9Phwklnb1hMAtwQbTDnustjjUceQf5A0_3-q9zdII9sQGoZay80yYSdO_L7zQVQdHkKznheF_Xy0)
* [Explanation of system context and flows](/docs/c4-diagrams/context/insurance-hub-system-context-analysis.md)

### Migration Notes

* None

## System Containers

* [Diagram source PlantUML](/docs/c4-diagrams/container/insurance-hub-container-diagram.puml)
* [Generated diagram on www.plantuml.com](https://www.plantuml.com/plantuml/uml/dLT1LoCv3hxdLsWvDFHx3RdiQKy30QPXcfriGZD7dk9I4WykkzPoGMVtxNzVo-KgAaN1qDnIjgNli_HPKdxXW3xKfPdyJLjbwe9W6qB5_vXEFJwTR7JOrgkQoIjd0zbmebmvhGnQiJdcK1Yzcix-VZoNfUyttwObSY0Vb-vdqGAr9NzIYVy9FsXReSSIJ5mDkuh0-R1raqdGmH1qvw7Gk95pQ-VXodBjqIg2h_KAbZiEL4ucXt2gWlCycPDdPuzmGpPyWOFdqwUoSX2NlZCnX2q19ri83fYC0TqThPpHIXC3sW8UDJt57sXsGIi-EVWycJIWzsUkjWNwtL5dUHzZqu5cYWUVuRyJ0813kFGfPWLyWbynq1FkqaPtpoEkC9h_GIkugoFZgXA-yUV9doo_ReMqjXj3nnLk2B2g8b4Csbcel7lKHTnCLvC4WOvWVesA8ka1qAQ1ZpvJM63kV43JiXAi6wqYMwp3FZ2G3Nu7bOlEKphG63YTNu6dVzV4WM7jNPauhFDj1Jq7OEOyGVBCv1-r8XxmYdZR-xmdvE8dB9jFuN6DZpZTO_OLRM68cmkBDTcGGvAoT_t7BGJtG1Os507Inijmf8JlUi3pjF0sz0rQt123ylICP_IQr4uP0hT-JL5klIRF8ooyAseL-ZIQbVVn25lg8sPJXG6DsuoXHKPsqqThLjv6cw5HjS503EA1M5Jm4fTXXKm5E0i5hIDW0Rusn6_47htQZgL0rj_cD4_Qb-X6CEjyYKR_Xuelq3Z5bQ7c6RjrpiGe4ToLPFV2twoyJu7DFRRE5A94fLnjGygtX4GHCp5aY17mmgawRVNWpzkrFe7VN33QxbFujP5sbbSfUkW87NkIR1NG8S0HdMnEli3y_98_Zp11tguS-gBFf5rxPnuO3N5NDDiwohNa9RsLaGZ4FFLZFukVxqJpXEOuw990VC2wjaem8bZO9NMcPi2H0KAihKkd7gZ9GLkNpZ4WB8Fpmu9qlchrMQmwJQRZ8czXiJW_krdAZyRyFIzTlEPdajqs7tj-RvpTkFEpdkUmVVjLPyzPOzbp-jZtF7SSDfwM__esfBqRw3OR1u-MCSLqz2xvwIR0_5m_mMcN_EOI5mPPFjD-3xZ_OA70W2bZcKvpMiWC9IKy_YTj_-9781zNyoJ0RNEEwqSFk7v0QICLgYt1R_APk3ocLnqyOIa5RsumHDHIzYvHQQD3yvfuPzNME-jg1kNAihPjRrbHU2Aoa0KhVFh8VxAdolaWmbqkqi--c5lIyWOXlrxdavp85kGPljx6qIc5GzlW0ELazuG7O06zNg_lrooTEls6XTJQf6ZSKBgMDfH3DBsvkzXBVIxxFjaWW-m3Aw-hCBpN2kr30tGMVqK032ICNiMQBUzwK68Et1b9gZkLvIePcGmm2wVudfFxVbLy3V7Ck5KFChTzAleHR5__8Ip8D0LfgokMXUzCCcC6yetYuTAufqayrewKN64U8bFrlxsTBwClEP1sdYUh6tmWJhEHGcCOWkiCfjVBt_y9dvwhaR0vRCSl2AuL2yFHybc33Ko7C1YMxj3eGdJR33mCJpfiXnmxunSZpyBLOjlDSS6zRfkBryUCX_t-vrraoNpCk9F01ysxzlWXyq6NctltGvCK5sifwIqRTyh8EasAFCwgW5c_5er8P9ZSbxFU8dDDMmGgJtNYJWRuPwKkBfQt1sDUnsHmIK5jYTiTA2YWDZpkKlwpzGjiKvNbkKcdRghrA6vRrkVrocWMlCEcCSyyoKi_119NcNK-_PhiPivoNRxJHzRTnwmxuNtKlbFUJzXF3hlUFwXrendjpJeBmgB9NEg_Jru7QgLzVNuso-HUY20llEsact0YAQcpZvJRCRTkXw7E2-_WDZzjVOodF7__fIEHgPJlxAqV_WzxsfzO6ZzoFZUpqHmDtsw_tNzp4JMlv0Ok5BgUU3NzFTCVKLzlIEdAWJJ9t3BVg0MZxWPzElTVkPodu3KzKd8_nd0yvS_3nbKfF8VpmwYdoIzaYxeq_mS0)
* [Explanation of system containers and flows](/docs/c4-diagrams/container/insurance-hub-container-analysis.md)

### Migration Notes

#### Data Stores

| Data Store                  | Java          | Go                 |
|-----------------------------|---------------|--------------------|
| Policy Database             | PostgreSQL    | PostgreSQL         |
| Document Database           | PostgreSQL    | PostgreSQL         |
| Product Database            | MongoDB       | PostgreSQL + JSONB |
| Payment Database            | PostgreSQL    | PostgreSQL         |
| Search & Analytics Database | Elasticsearch | Elasticsearch      |

<details>
<summary>Reasoning for using PostgreSQL with JSONB for storing insurance products</summary>

1. **Consolidation of Database Technologies**: Given that PostgreSQL is already used to store
   policies, payments, and documents-related metadata, moving `Product Database` to PostgreSQL with
   JSONB, we will consolidate our relational database needs to a single technology stack. This
   simplifies operations, reduces the learning curve for new team members, and streamlines tooling
   and monitoring.
2. **JSONB Capabilities**: PostgreSQL's `JSONB` data type provides excellent support for
   semi-structured data, offering schema flexibility similar to what MongoDB provides. You can store
   your product data, which might have varying attributes, in `JSONB` columns. Importantly, `JSONB`
   is stored in a decomposed binary format, allowing for efficient indexing and querying of data
   within the JSON document.
3. **ACID Compliance and Relational Features**: While providing document-like flexibility,
   PostgreSQL retains its strong relational database features, including ACID (Atomicity,
   Consistency, Isolation, Durability) properties, mature transaction support, and the ability to
   join JSONB data with other relational tables if needed. This hybrid approach gives us the best
   of both worlds.
4. **Performance Considerations**: For many use cases, PostgreSQL with JSONB can offer comparable or
   even competitive performance to MongoDB, particularly for querying JSON. While
   MongoDB is often lauded for its performance with large-scale, dynamic data, PostgreSQL's
   continuous improvements in JSONB handling have made it a strong contender for many NoSQL-like
   workloads.
5. **Go Ecosystem Support**: Go has robust and mature drivers and ORMs for PostgreSQL, making the
   integration straightforward.

</details>

#### External systems
   
| External System          | Java        | Go                |
|--------------------------|-------------|-------------------|
| Event streaming platform | Kafka       | Kafka             |
| Bank statements storage  | File system | MinIO             |
| Documents storage        | File system | MinIO             |
| Tariff rules storage     | File system | Tarantool         |
| PDF reports generator    | JSReports   | chromedp(library) |

<details>
<summary>Reasoning for using Tarantool for tariff rule scripts storage and execution</summary>

1. **Extreme Performance:** This is the most significant benefit. Tarantool is an in-memory database
   and application server. By rewriting the pricing rules in Lua and executing them as stored
   procedures, the calculations would occur at in-memory speeds, right next to the data. This will
   almost certainly be drastically faster than the current architecture's chain of
   `HTTP Request -> Service Logic -> File I/O -> Script Interpretation`.
2. **Superior Decoupling:** The pricing logic becomes a self-contained, language-agnostic component
   within Tarantool. The new component in Go becomes incredibly simple: its only job is to receive a request,
   call the appropriate Lua function in Tarantool with the necessary parameters, and return the
   result. We could update the pricing rules dynamically without ever redeploying the `pricing-service`.
3. **Centralized and Atomic Logic:** Managing business rules in a database is far more robust than
   managing script files. With Tarantool, we can update pricing rules transactionally, ensuring
   that the system is never in an inconsistent state. It creates a single source of truth for
   pricing.
4. **Future-Proofing:** By moving the logic into Tarantool, we make it accessible to _any_ service,
   regardless of the programming language. If we later add a new microservice in Python or Rust
   that needs to calculate a price, it can call the exact same Lua procedure in Tarantool that our
   Go service uses.

</details>

<details>
<summary>Reasoning for chromedp for generating PDF documents</summary>

1. **Architectural Simplification:** We eliminate the need for the external `JSReport` service. This
   means one less component to deploy, scale, monitor, and maintain, which reduces operational
   complexity and cost.
2. **High Fidelity Rendering:** Since we are using a real browser engine (Chrome's Blink), we get
   exceptionally high-quality rendering that supports modern HTML5, CSS3, and even JavaScript within
   the templates. Our existing templates are very likely to work with minimal to no changes.
3. **Self-Contained Service:** The `JSReport` service is replaced by a single, self-contained Go
   binary with no external runtime dependencies for PDF generation (though it does need access to a
   Chrome/Chromium executable on the same machine or in the same container).
4. **Performance:** We remove the network latency of the HTTP call to `JSReport`, which could lead
   to faster document generation.

</details>

#### External Exposure and Interservice Communication

Use gRPC for internal service communication while exposing select services via gRPC-gateway to
provide HTTP/OpenAPI functionality, combining the performance benefits of gRPC with the universal
compatibility of REST APIs.

<details>
<summary>Reasoning for using gRPC with gRPC-gateway</summary>

1. **Protocol Optimization**
   - **gRPC for internal communication**: provides superior performance, type safety, bidirectional
     streaming, and efficient binary serialization between your Go services
   - **HTTP/REST for external exposure**: ensures universal compatibility with web frontends, mobile
     apps, and third-party integrations

2. **Single API Definition** removes duplication and ensures consistency across protocols
   - Define APIs once in `.proto` files
   - Auto-generate GRPC server/client code
   - Auto-generate HTTP/JSON handlers
   - Auto-generate OpenAPI/Swagger documentation

3. **Performance Benefits**
   - Internal GRPC communication is ~7-10x faster than HTTP/JSON
   - Binary protocol reduces serialization overhead
   - HTTP/JSON translation only occurs at the edge where needed

4. **Typical Flow**

```
External Client (HTTP/JSON)
    └──> API Gateway (HTTP)
           └──> grpc-gateway (HTTP to gRPC)
                  └──> gRPC Service

Internal Microservices
    └──> Direct gRPC calls between each other
```

</details>


## System Container Components

1. **agent-portal-gateway**

* [Diagram source PlantUML](/docs/c4-diagrams/component/agent-portal-gateway-component-diagram.puml)
* [Generated diagram on www.plantuml.com](//www.plantuml.com/plantuml/png/ZLN1SkCs3BthAz0ScdIcYIyzxMdT9DjkfzlnnDdTemScOOarHQeaPLVJwRyNfAI4YjmT-KI2UC0py22yzm5TQ6jTVAUCqAqag49e_BlLok7vhbIXQlUj9oUi2MJ2dR3rgj5e8kRM1wdLVdN_q-qccZv_-drLem_asBIxjtLZJSGqCNxXZyeqwB06hGo5hY6mBbIsA88Ack357wJ2CleTh8Dr6IqRzaGDls2WCtP5SGsFVtCQmxPjnmbh_mwUAm8oyZQolVQmT_RC9q0Z8V2Jj6VZWoEEMolXBB-Tb21Vz05s7F36D_WZN6sLAPdF1ak2TTDe9J0eQwxuwKjBTt_wU8hP3YuLHGA-UW6dbx3lG1dVEZI20EDVy7TNF-Ifi0tLRk30uTPyXMr_ZU4_PHIdmCPogYw3Rf9X8HYxcidawDwo32xHLtkBJcO17aRRGWREobPC6FIMfN0bk3qvlBSiWuiAyzJtV5q8jDnE7I7f49q773meB-o9NCU8Wfy3AaDkzxDjZKJNtPIzQ1bnGSiCWdyAuDyr3u3Bfi23FKJXZex9wUNr9avf-YVaEFAlpyyRsAPRfFO7XT35mre8QZWKQWtAyEp6IZdwgoNFLjPl3I4JSjJeD8spROZr9bCg4qlsr1lWCHbUYcPOp-c2GLJannpGOAWy10jSm8CgMqSodyIXrX3Ja9-dJrDoK3gG6uQ4hUEaVKZsd49ifcYT2bts-D7m8PLXP9K8dL0hYO7Wjw_FV3-IyN5i1PUA_rygIpwKSswf0q8hFeyTk4-tAQC74XeTCpvHzlx1kZCwEQKKSsBJECign_3_dwmvb-5b9qSjNjBdHNgzddDcb3gOo1WAP-kEe6rVygJ9UVjw9GsX8hb1q4-aUrYb6Wzd5IfbPf9cfwcOPvBReFSqgHId6A5llQUAIPzlnlQ621t3P24ca6bNrrhRimVhG999WVg-SSPlSCXZp5iD9uKPUE9ygO-VFGt4lTKd6drUcyB1_irNuhJk1T_wnPPNEKxgaUEkDn-Jv5DL1nblLq-FssVu7hxIVcl5aMAnPbJVBB0lmpZvrtbA7Py6lHHejj3Y9sRMxnbiligMuUOxR2bolhgMulATjHoNBwlB8BQ-xT451RtihYSgbG_a-ba4D18ubbFauyo-9oFRMly7)
* [Explanation of system containers and flows](/docs/c4-diagrams/component/agent-portal-gateway-component-analysis.md)

2. **auth-service**
* [Diagram source PlantUML](/docs/c4-diagrams/component/auth-service-component-diagram.puml)
* [Generated diagram on www.plantuml.com](//www.plantuml.com/plantuml/png/XLF1Rjim3BtxAxXSrW9hSzbfftPjrwLeWIn9iMF0M8ojLPOqaKuQ3FltIRRZUiw0tIpolSSdwlcA1OFKbSdUQPkRMX6K8fu_JQS1zvU5bhBUr4mXTrR8ocNkggatQ1FdWaKPlPdUVBoOfzBpq-EqGXOAiRI-SPLtDd5yqi_uHLkF0Iimsf8SF84BKhei4os6eCU3qbWatDO5kAwbX2M5dSufoswY2upiiFxiQgim7Cum0jRS0jQRhle19aFYv1n-PG3mDkCClOwWHrTe2qarE6CeJ6BjIUV1sIWBYxlbQjIyU_MEYG7R9bdbdRRIM4rhWcGdwkiSHJjxEJaVpqrsVN0xhIWqDeTuc7UTDEi1TpZjtVHtYPslQ9KXXaW5umgTWzl23erMKSKMhPCya4hAQFZKne-z35qyV5zreySxY9tXv7ko55288Le0reNb1YBkXU9d7UM1wpmdvcrj_hkDP7GToBie_PnCB-8tQt7Xq6nWVZsemCmAXIssJcvfgsstWnJEW7dx384aQDhrUr0e2DlWgWHjJXjaElMYDcjKw8L2KkzWSDsMZcvcbJTKHNXpeLJjAusLTcHuyomETBATtEsrb2ScVcVPyi12rVhkLSuA5DfZazyYQiBS1K43zsrvakhpMNyy7rBL9dRdZgK8jFps2CSh9DA2J6COJL-EvEmz71jSQizPFBqvGAyRvi-QM7Zqb7tWcpYkLlFbDFqGKJHfDDHnqc_9K18_aHBNqKQCOJY-aEGbyKcoOQVnt-nHmcEwE3r6qGMuJMn77KpwAmKp1dryNbAmENJu8QXP-u9GyIXkNMGYvOgigYlp1m00)
* [Explanation of system containers and flows](/docs/c4-diagrams/component/auth-service-component-analysis.md)

3. **chat-service**
* [Diagram source PlantUML](/docs/c4-diagrams/component/chat-service-component-diagram.puml)
* [Generated diagram on www.plantuml.com](//www.plantuml.com/plantuml/png/XPD1Rzi-3CNl-XJyvz8M-BUvxBHJsw0RDYn0iQ3OqQ1bpX4gKu98Dos6VVUPiEDaJOlTegVtUwH5vbeKY_PTTFy5zh5l2BQgMJukbmLtLstGRL_tGiKdLcAzygbRveXipALe4qEzN7sul3VfOVrjsQ4ebK6gLgdBYOt9bk_aCN36WXt4mAGlcI0LtIRdD6WacFtG16pDzpCLM6rHOKFbANXoRfLOSQ1BTPjwRh2ydFl1KCbegEf9_HyMn-3Y0duv03ZKEDzHBSa_qiXIsHC_gDwOFh9K5iF5ElYI6FjtRf6n9O5CHO8eyR7D9sRo6X8B83VGaSZWXheaR3oA1cwl5XUlcfjSbKyDUIinKIixMysl-8JBkQq3QNTtRDXOhg7njptIlhP0JReZOiWH0uFIivePH4lljIyqSAXusfQGI4XSTVR5P4-s6HLOZyg_MbjZiFbDRw45_QC0nWZeDJmH-1Z-VhwfebWllvtRl8XILzqzwtcBIZkqGT-qnjodeXZXyoWlJB__CXylZj6wf9rGsQDdOWNXTbID_5HisRc1cvnZy6ZZ6oASEuFl5D6EiWrPt70wf1qwMer35z1aSVFd31b6pCOtTl1E5EiOP3iDC9Vq74ZUt2ZxVqoHfqclL-X1oFgnG4yY4DYdBd0BLYNrsYOxJ9Iy6tko0dFmg9mi_BpenzdkchZfk_W7)
* [Explanation of system containers and flows](/docs/c4-diagrams/component/chat-service-component-analysis.md)

4. **dashboard-service**
* [Diagram source PlantUML](/docs/c4-diagrams/component/dashboard-service-component-diagram.puml)
* [Generated diagram on www.plantuml.com](//www.plantuml.com/plantuml/png/RLLDSzis4BtpLw0-nCvCOrrwwYcEx3HkxHcDvKoFcYMu8Z460NONjCpfzByN2yWCH4KdSJzs7zvRB3vp00fZRwjVZDDsR51r8Gpy-sf5SBXkJUZ6UcGaxLr05wwrxrU31ISvdpWqrjIhzM-VDcBw_lYmwe43KZJjrhuVl9ESGUfN_6BS00IziiPXc0PKdaBdgogOO57DyQenq4hStfEw1Uvg3zIeBTAhqLXLb-hkBI0vi6exSS2U5RZPprKsxcBGLGi13p3zgYvkMgcyYHrZsX_PV27spNtvAKMGLJDtRI202bw53jMU4WdDzSN7iidWhT7JZdF_M6IJ3E-0fEoZqUJvn_TchAtX3WMvmbU1TkZGAL0E3oeNL8QL9eI0ouOli7y1mJw0Zh3-aa-fUfSARGCXzCQrAeeI8eUz-BwGVq7Yt8nLZU60wDGH4oywDBMKiy31Q4OWtMLov9_we6uSs4bSwiwrnc5o1a-ObO2s9HJgMJ5Ov4oYg0cIo2QrgzRU1OZPjFlYHzS0JLSpxmMRPnDmyL7zMwdukrIYtWDCIEbxdg0h64oPcUAa7NbhaMP578n1FTrjdnVEkxV1Ct9seMi6RuGqEK4-4Cm4W6iMqvBEbk5bGRx562jwV52tlWVZr8DlZLv0JiBiEeb5ceUeB96n9RNLW-60BbksOysQJ8qiWtgP4zTvSYwpuCaJoBGjKgc9SGs-HMWHymBEVC92YLdsShJ_X5TOpMoMdWrvZSmu3vrmDH0EGAUJqNWzzlZEy1BJaSiD4gT3Qun4thiz0GSQTHW95zXJwLriv8MTrETM-Zn52vlWQRfOZlV2Tujxuv3JhTSo6g130lVFY3H5S7AM6MbnbdCYcte73Gm1wQpdJRQ_iwXElMjhOhuux_l1eX2K0T4CDI88I7lGg8BF7mBqO49tMkmCLjuXE-qTH-ffdgjrDYokIF8LW6AKGvscAlk43k7d0DHmEN8TdavmSJcUq48miLzd1XQRMFBDFH7mEwFKojJ_s2tvikLpIURo0fqDS55go9Dv15hK-4dIOfXUJqTtvAX_KQ2CFb7-dfKvoYZOwwb8AWFJvlsRJCX8XLT2Q5WUd_viR6Mn5OME3yEPjbzFb8brbpb5y78FFUUj8IpzLxwz2_tYBkR9wOwyyoCVHVzg_Q6I9eidCYCity7bsYgGIjDjKJfTvRdo_CBdbVy8ByZ2Yj9WRQAmnR3Oq4BZj-VdpNOb2pvs-8ok6NlxFm00)
* [Explanation of system containers and flows](/docs/c4-diagrams/component/dashboard-service-component-analysis.md)

5. **document-service**
* [Diagram source PlantUML](/docs/c4-diagrams/component/documents-service-component-diagram.puml)
* [Generated diagram on www.plantuml.com](//www.plantuml.com/plantuml/png/VLPDSnit3BthLw2-s9bfh4jFFSNnH-B6dcWiPthKKBlGBcikoI6uLZMT_lU2u6f3qPxwv2K-yF3mGEeJHHNYE9Z5BzesPcmH-XWz_RvS1hM_x7Jin-r861fd8zfusRXXwOsoAUOZnTRexVBwju-hTFJZyM4vA8eO-6XpxGRlR8hnAV-2NhJrAgW1ZBOO3nx1XTYxnIBgQ11cVsYrwfBVpWMuSSquy2716iEhRd2nE8VRlxc6LGRM1wus42ZR7ksqo8SRThheLCIzElmAPrTTohpYYXps9H-VfVFL_ScdCMvFa3ecY0vQjxV6gHOu70FxjT0U4LsUVIXhUMTqSzXGXi6vLd9mn9MoF-ecEFhvlHgtHbEFgG70ruHmtwC51HRtu7Ey9cW2fj9LmHUrUr49irTDZ_0jVQQijv9e7JbeqBO3daraAWT1W4IgGzW6zu9165Pqi4qVd7KZPH1rPtzHGEz2vFW_ra_oRzdLF8tLpHryoJnfP-7MTjgAnnFQDX7wzPaLqggeGDleGAM8cS-gw8uuC4zVkd51TPBiJXkS1WzB-6pSjhIkWdlLBH9uBgWffc3APkaszbZCCjNVSJxfU77jR5IQRPlFRhIj2eUBUTZ5NDz8ykm3_BC0_Zk79AS7TS0WtxEaBvJNHQIufMh16ODXbePLOuIds_LpQHI6lIEaR68klTDSFlKp2vG7VQhC2L0MmrTbMyCkxsAJcM-Ca8LX5kuK-Y3d6OT8R3vXzh-vo6cJQJrkgGbwYx8svpd5TTRjUPQLM6BGNOT1cEzchJ3W2fI8UzCuIznIc6jVoq5DsMGpcYEJXRqiDhbWjd7_YQwz2YsLQ7gisYoek_AUcn1yonitA6tXmNMwgP1o5--8erY4SbSoOUN9zy3BIp7faIUAiUbbb2fcq8qoCZX6MdBcmf6o2UoztGN5QSOcZW5XER515LZVxZPp2gvUhAmBHmQBFI-ErcYPkuY3DunLm0dAYSRwPX1r1bbynlzsm2pMJU28ahEKWJGZETIBVjKg7_FOHSj8ijMSMO04Z47ZQ_gSLnfsmGrGto35V9_Go7oervvWhoCpBwrCqnGtTihBM-3zGQBoFAsVMoSjveXwfKuryfnte0muSQY6DDVBpq3gyFt8Tq6IUgr3feVZpOhTdIm81nSnjNFTOTdKl-KRVKep6wxAzoOltvrn-wINwWLPS6Zzh6RKvTjPNpO5UabGiLayPbCb9Aax4ij71FRyl5gcgpOdA9GgRzAVGHz3efjrUh_ypkxSthheRkvhLk7DT5rBuldNINuT7jKBaZmDQUbFVduSOQt_1zSJgbPWYV1hO9_GjkDW_WC0)
* [Explanation of system containers and flows](/docs/c4-diagrams/component/documents-service-component-analysis.md)

6. **payment-service**
* [Diagram source PlantUML](/docs/c4-diagrams/component/payment-service-component-diagram.puml)
* [Generated diagram on www.plantuml.com](//www.plantuml.com/plantuml/png/VLLDS-Cs3BtxLx2v99dfnfUUUbhNctIpJQPkdEtL0ucmp0b5gW0LhwVJ_ruIj2APpkHcFtpmwU61_Cm1AFIjdVraN6rxZMeNGiU_pkS4-vl6X5rVzOnKUnVGXPlQj_FEWairdpXeQwhvyfTFgmHzVtoOjy01AKARfMyxxr9Db_hF-CMu3WXQPOt3SEXGUGexFvi54oogjtob3JGfR-j9hU3G9coDz6fgdCsMaGZ41hJvpVTE0nskkfopuPppixeegYwkrRypfTHunXLqPfAtMDshr9YyjKWNCV9eQl8E-g2URjVFHV3sH-SPEOVGwSuR5rZuTjwQ-g2WhdsVC71Q7VdnpSNr6Olk7TQBhejD81ZlthuWXh_1Ayn7NfF8drJla0D1G1vEKxv3aXwPHEqzQUCaHViMZ5FMDwO-9uMlISnTBB98YLR-fDi4gwy2Ymf_mFO5r8FXW2uZwxxYcao5h89NbxbmIGW1zQMIlXAf1L8EzwLUvsnC_47JsIxNVwjx0QSIhAC2khUerJTV9M15laPEKwh0lIWE451qsHeRmItvLeKTob_51uvHvPq2nSTEYKh19PFT7CcEqYmo84DQBTIYQGWR22X60WSDifmb99JVAfX-jxJAssTS4-bQS3L-x9mtpnDs_eo8Ueeec-3fC70Q4NNl0j8MicvVS6lSaLxQSO8wY94rXCWIYMM-DOv--f1DK_fPs3In2PqP-elOS8hSkXewxYs4J2bRLFYGD45A4Wsov2b2EM5eObiExtchuAsh3MZeOjj41m9KmAWM6HgaYsQpqbW-8A5lI2P9exPcq5O5Btz4pxq9EybSUGuDuVgl1wMFfvsB-PBsQbDxntsBzBPeIm7As-aOimQp_sAMmpglMOw1qqd0FP3cSGU5pibAdnD9gx7fyXvvEgxUNGJLQW27Usciajq3OcGv-HMiqH3Erp3rIWV8MFwRpTQoWflR7-4ghSuU3h7HeacfAqy1hFezm-c0T5yFVw-dfNdaKmyACFMOQ7TCE2qMuLFt3keTPlbIHPPf7GYXJVPRMGXHqVQqMbSnTJBWmKwfmnDQCG_O0IwEtdBC4capA5TQy0GDYlkZMeM0dDny6TDTlIFlVC_gplezp-9PeuBvcNk45sHvv6gmDeq_zV_w_BnQpzCR5bkbAaa-VPBk1kCG_jCZYtM6x6bYSHrzP-IFqveHd6QVzZbPptjMPjWxrAew74kcIReIiK7dgq4Sk2SJK7ZdVSwwBNWYd0nOv9EEfOa6NwpwoXhU8R__j8tI70lAHHxLBFEBnF85VYRJD4Y3I4Nux5NAj8RiCboCQWsloAhdQEoipCbBEefIliFbvJ2TOXdRyZ2MSUrbG3c_xFsnJMQVqUc-jVy3)
* [Explanation of system containers and flows](/docs/c4-diagrams/component/payment-service-component-analysis.md)

7. **policy-search-service**
* [Diagram source PlantUML](/docs/c4-diagrams/component/policy-search-service-component-diagram.puml)
* [Generated diagram on www.plantuml.com](//www.plantuml.com/plantuml/png/ZLJDSYCr4BxFKpGviAQAn1TEdDO91h9imBNEiaTNUzIsXJMIwDROcQ9uTzII6ModKaKk6VVqzwElU_HU4dBgEzTyPNthUaEmIodAzzCfu_5kQzEkN_T2t0QVoAUxDdJJwD0hvbQISNOzVVZkTg6bpqyVfnrA8iwbrKFeOl2AYShVoDxwY8mTEEif3P4WSDg5faasEOAn7up5hVPj0iCYEDiEi2JaTfV_yS6sr3GBOWb-eiw-XPj7BpsZRmbcsqnmaqipq7SGDf1s17Pi47Ga4BCokhkRRvg7u1DcFpoHY1dtXTRmUv-9ObIQ_7ZtX-ZJWiF16XBbgzpM9-8DjbICncfKYj5BvYqcEkAWhjGUB8ew_5JBIlvaMmuU-sBzEGk8zLj7aBjvoDHPgeYWSp1RF0BJdpr9aakTQc4bDQJCD8PN2g-4dj3ZbWHQ9amsU4shSDXSH6yWzcjdPKS2T21VvPhb88cwrVmbJVQusQCUAsARJV-YFminYMHckEUm9ywWCmn9RfWxb6JR6fOYJlFz6cOUtQ2lOEwtrfCgZYTStOVU6-HX4aLfwe5lAyrjFNT6m5yDvBzneIOOxQXHybD63iuHg_Yd-VBvgZH_YK58eBmYRye8fCmW9yz37iyObQPogTS6Btr7_Dy8vYM_t59Vg4H92pvQIUHhfJuNbHe_XvP4RRohD0ywA3BlwZXo8uUkflxQW_M6NiujF6gX2dt00uwjTUSOlMJTJYet64oe6nu0JpkDQqV0X0QwOCYzLcIAuNgsy2aNnQR0PSz_KDPPgwUwrFyPlN4aPS5LOtfacmX292whAN2qQLU-lKj-zRb68RMZVhAWg_C-sVci-QK0cnp8EBBgNNlFPdMM68hGHH8fd476nYi9mGDLYQ6WCkJlfb54lQSauhY6LCTyPaZxIiTuNUHMR-GKVzqxDQ9nFJylbjCFozz-FG57J5tr7mCVaVydjfw2HBy4GdDQgobyqH7emSPl97yw6QEWrJss-xFi_hq9weA_jR65kQfUNrOZmwBUEMzHr4aqxycRldF_0000)
* [Explanation of system containers and flows](/docs/c4-diagrams/component/policy-search-service-component-analysis.md)

8. **policy-service**
* [Diagram source PlantUML](/docs/c4-diagrams/component/policy-service-component-diagram.puml)
* [Generated diagram on www.plantuml.com](//www.plantuml.com/plantuml/png/bLP1RoCt3xtxL-ZB9Gdm9RxqrDDcdM0txGRrsjcpGKkSiM2DD1KvoHf5_tj5oUCPUnPRr0S38ld8fqUHc0_44BbhtEn_rclN6LGxvfP-dSyZlD_NbdVTjYECEdX6p_SwDFFMWHVC7R5nTZjV_7At5DEtbo_p1eWn9jDc4PesUC6qadz6U-jRYD0ePptoeKKL8k_2RCQM7QfJl38MQechGbJBuAm-g3N6DwjnDhjMJzyPemUdrWTYR4Y1DxsVPiMuIK4tDJ2-m-7_wkgXbhJB43d1FXNpbTYNp-FZwmvL6sq3yQ0I8FstmNhEF2HKWtDqVtKxBfBYjVNrXWg1b6LPB3qbIVnYTGmqd1VWTEU0aPJWaN89wwcBuBMG2ARJV5bh3zKUX7OBEb7zNOwIxkbDhhVcYD18vTGCJWcRN1g9e4QrZM6FCTS1EdYzYy67ZXGcxAIGsIRawl7ZorfIh33biq4aVmI6BH2AUSqXoWLAWwG9eQemAfDY9Dzi4Jo3zHWt7qFdJLBrfWJtOcssnIujEk_prQtwQwRIxpeB_mKE6EKyF98RQEq0ao0f5uDp64-IU-XOhPxMhnVEf-zj8AJYGczocqiJT4HW4J5VfZokpDfYLkd8Ql5rjLPtGgV9pyyQlE2dYwk_wy2rnupUns_m1lE1ySZpEKKw90NEgVTe6LLeCUPsa79sZoV2ywurFsD-Jg_l1DHrn1fO-FqXk7clQE-WJ73vC5Z4y1WQi5urmQ0ZnJjWXLv3I_bP9mEgRKVM8oMQeROwqo5EJf5vGknSrgyTniEFHFrJ75D9S_n_5pGYcB6UcTYqroji0raEyJ1zY8EICKKDZ0PCBzyeoxDdZ1NeeYHM8bEMJ9Pi15qsZioHIkJ84gFNPvs_4Uhp_21kfxqrsmqOQ1bZoj-Fh7eeffxFSzCwR59uJYdMawMGYGDX3ieAPw7sRdcN_UQOUAJKiwyY4CTESnTHpTN2MSbtmQ_VcJfxfolp23iVuy-lhykn0_P8Qhp9P9ZBYXQ-ml0YxLIel50tPTjciV9ALMMVBhkjixIxN2SbP23IXv6wBhrVo42YkIwhDPCf6AWOeu9-OrfI16zeHlhrcvPsjgMijFNv9iSNBs4IL9RVTCEiGiT8PL7qRY6GAfmXynXDSNaUn6TnX3f19_KcVVn66QXgvEn4wOVkZfSQiPYccgwZecFPOqqmjhBuqnIJPhv6MzSOCwEsTAdqP9HbMlTyd9_fD896RGy9UOAEHPpWUYKgPBqx-lB4J6iNn7XcfQhjXx6l-_Vus-VyfSpIQVZQoHqkyp5yjKWxarM6Q3sNIKaP1NNPmkddp2TaEZQpYg7vOPOn-VBjW60enqlxoeFC7ChoAR39-ENpluzKUPgp3-XDrxX_0000)
* [Explanation of system containers and flows](/docs/c4-diagrams/component/policy-service-component-analysis.md)

9. **pricing-service**
* [Diagram source PlantUML](/docs/c4-diagrams/component/pricing-service-component-diagram.puml)
* [Generated diagram on www.plantuml.com](//www.plantuml.com/plantuml/png/TLHDR-Cs4BthLqnzsIpGZIuzzRJRr46tSB26dItGay5G8siGYcHdHac4el-zf0WvaelwPCt7lCVtEFmiQbY7tbK_aBTkQ10wrIW_rpMRrzipQJSy3O9iWrVqUcj3NqTdVExv9DeuUghlVlgqpw7l3xkwDwB8ANIw2tqCFlV4FB-IP_BHiEd1aKST8q9WxK9LAQb3kDH3G-QSwzh0i6UovCzmH7uXYrNr0RPlYkoDW-CeYhs0ySsSbwe4Jwde9WP7TZn9IVq8c_qKc6itAV90beEyVn_mhm551IAd25ZZxE2CKl0oqI4l0nkVKg5jaULsyt69Q8DlwNng9Oswc_uFF7L33VVa44fjHlhpIrBhuO_jRaf83kqvl5232HnPIBBU81hOd742LyFKji23mmcuIX1go2EVVWc3RmoFDx7ejJpqMi7DH_YxWlJx05_sNs5dHkJy_Qx_ZOcqwCjL6OY3SyWNqRmP50xRu-DLSliMWw2K5Fec1l9QnBkewS-JlkKKCvaO7Tb9hFhNq1loi0jdibVSyep5uUxU3LhQ-hjvCVM5vZBpZMs7ecmK1RHRMGnF8vX4Oqm4IoumezLhuQyeJU4J-ZFvJ6doz91Zi9rYcpcuVJ5kC1fuCjkmOBcx-8Pso7pIfgLwaO84hqogw84yvFx_8XTU9yOOqiJ7mlAGleGIoZWhyTwH8xjWce8Rv_jchCse6fOdXPOoYPP3dyGedo3J_LtOTi2YdNGK4sFIZlnKBaNpN9QBogMwSky-yAlXHbOcS5b1q91Gvkvru_hStmKdxYsgxLPU_U-0jMNpXDc8aWPpDkH5eJ5g5fDMuCk5By9cfuf-OfcY5WMpyDC3yBN-bcRzitp7rXgcn77qjkFWmo1mxyBhvI54MDptAfEvVkBAwZwOPvIyk5bObuzsKHZBvcK-lpq-xezrtjDivsVqpT2xVm40)
* [Explanation of system containers and flows](/docs/c4-diagrams/component/pricing-service-component-analysis.md)

10. **product-service**
* [Diagram source PlantUML](/docs/c4-diagrams/component/product-service-component-diagram.puml)
* [Generated diagram on www.plantuml.com](//www.plantuml.com/plantuml/png/TLJ1SXit3BtlLw0wDFQC8rrwwYc9vRQUiJkgvPmr41TQSS8bMG1hHTFflrTOIglDDZaI1F0U7XxvGHHPkpPKF_deGbSJx5Mp_BfOC1xcZTTzj-s4sAMe57NkKhl80QFLl1UjWzykxdzvlxBGv-UdHOkYnAVGvZwrEKMhoTQ_aYy-PcHi8VX8Uim4YNMVgagz1e8X7sgFZUNj4iEAKzqvXJNnctTKLU_WuQiIHmomFefIAu2nljnBLOARKz9DWqe7FDx1x6DZVLU95GFyNi8pYwyUnySJs9klII0NL84Q5K4Jw9vWnxq6zNnsEqR9ANXtt4WXO5twm8MHzNtsZfDSpx-HklqL1chQ-UZLfoXmG_DcVWT_ToHzu1OEUuhWc51zR23jTiGouL1l3IN59Yq_6S2VQVtN4ooJwreRV8cAMvGUUws9IVg1V9IECJeQY3XK3AcnxjLzYee-4cy-fIxMoCURSzferibwPhVmJmK0y0vCsYSy4jlvkjmRp7vKPra6n2a4ua6hY9t2oyFwTNBvy3Kd8IbN5EkSV5JfZQBxxuzHs2nJYpx2px0Y5YzAqT64sBduIcvsqNGGqY8lb9c4eXODHL49qWumJlMqNbu5N7eZbZkpwNMjnksx-1kcd4OAdV2IU4ry7AjJTZgvN9gDphjrfXiwDMsAY_DrSaYd0nQ_TMAkOaAd_eqWeofnb95sZt77ACgTquwdgjNR3TQObTW8d7q67qkew7NkNAHyR7CWqxA7juGXKeZpC1BugCGxT0IQoi46EdZTzvbdlqDzHXrHVg5GnjlxB1QpIB7UHERFOe8bMmmVBvSoknsAlis_ckGP8pRquynlX7aKy9SngORjSLHsJRIYebWjzjkqlMKExBNdUFNZeEbQcR0r4l-EVyR9_8Oo_8KcWh7_GjA_FeSXz0e4Bpe8O5X_lBwkrWjxQhDRwp7zwNxSgY4T_MsAFlo_OVM1OjsruJy0)
* [Explanation of system containers and flows](/docs/c4-diagrams/component/product-service-component-analysis.md)

### Migration Notes

#### Component Migration Strategy

| Component                 | Current Stack                                  | Go Migration Approach                                                                                                                                            |
|---------------------------|------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **agent-portal-gateway**  | Micronaut Gateway                              | [Envoy Proxy](https://www.envoyproxy.io/) for routing and load balancing                                                                                         |
| **auth-service**          | Micronaut Security + Micronaut Data JPA        | gRPC service + [grpc-gateway](https://github.com/grpc-ecosystem/grpc-gateway) + [golang-jwt](https://github.com/golang-jwt/jwt) + [GORM](https://gorm.io/)       |
| **chat-service**          | Micronaut + WebSocket + Micronaut Data JPA     | gRPC service + [gorilla/websocket](https://github.com/gorilla/websocket) + [GORM](https://gorm.io/)                                                              |
| **dashboard-service**     | Micronaut + Micronaut Data JPA + Elasticsearch | gRPC service + [grpc-gateway](https://github.com/grpc-ecosystem/grpc-gateway) + [GORM](https://gorm.io/) + [olivere/elastic](https://github.com/olivere/elastic) |
| **document-service**      | Micronaut + Micronaut Data JPA + File Storage  | gRPC service + [grpc-gateway](https://github.com/grpc-ecosystem/grpc-gateway) + [GORM](https://gorm.io/) + [MinIO Go SDK](https://github.com/minio/minio-go)     |
| **policy-service**        | Micronaut + Micronaut Data JPA                 | gRPC service + [grpc-gateway](https://github.com/grpc-ecosystem/grpc-gateway) + [GORM](https://gorm.io/)                                                         |
| **payment-service**       | Micronaut + Micronaut Data JPA                 | gRPC service + [grpc-gateway](https://github.com/grpc-ecosystem/grpc-gateway) + [GORM](https://gorm.io/)                                                         |
| **pricing-service**       | Micronaut + File Scripts                       | gRPC service + [Tarantool Go Connector](https://github.com/tarantool/go-tarantool)                                                                               |
| **product-service**       | Micronaut + MongoDB                            | gRPC service + [grpc-gateway](https://github.com/grpc-ecosystem/grpc-gateway) + [GORM](https://gorm.io/) + PostgreSQL JSONB                                      |
| **policy-search-service** | Micronaut + Elasticsearch                      | gRPC service + [olivere/elastic](https://github.com/olivere/elastic)                                                                                             |

#### Component-Specific Migration Details

**1. agent-portal-gateway**

- **Current**: Micronaut Gateway for routing and load balancing.
- **Migration**: Replace with Envoy Proxy for advanced routing, service discovery, and load
  balancing.
- **Key Changes**:
  - The gateway's role is simplified to a pure L7 proxy.
  - HTTP-to-gRPC translation is delegated to individual backend services using `grpc-gateway`.
  - Envoy configuration will manage routing, TLS termination, and observability.

<details>
<summary>Reasoning for replacing agent-portal-gateway with Envoy Proxy in Kubernetes</summary>

1. **Kubernetes-Native Integration & Ecosystem Alignment**

* **Industry Standard:** Envoy is a CNCF (Cloud Native Computing Foundation) graduated project, the
  same foundation that governs Kubernetes itself. It is the de-facto standard for high-performance
  networking in cloud-native environments.
* **Ingress Control:** Many of the most powerful Kubernetes Ingress Controllers (such as
  Emissary-ingress, Contour, and Gloo Edge) are built directly on top of Envoy. This means adopting
  Envoy aligns with established, battle-tested patterns for managing traffic into a Kubernetes
  cluster. You can manage routes declaratively using Kubernetes manifests (CRDs).
* **Service Mesh Foundation:** Using Envoy as an edge proxy (API Gateway/Ingress) is the first step
  toward implementing a service mesh (like Istio or Linkerd). A service mesh uses Envoy as a sidecar
  to manage all inter-service (east-west) traffic, providing uniform observability, security, and
  traffic control across the entire cluster. This makes Envoy a strategic, future-proof choice.

2. **Decoupling and Separation of Concerns**

* **Infrastructure vs. Application Logic:** The Micronaut gateway combines application logic with
  infrastructure concerns (routing, load balancing, TLS termination). Envoy is a dedicated,
  out-of-process proxy, which cleanly separates network traffic management from the business logic
  of the Go microservices.
* **Team Autonomy:** This separation allows the platform/operations team to manage the gateway
  configuration (routing, security policies, etc.) independently of the development teams, who can
  focus solely on writing and deploying their Go services.

3. **Superior Performance and Resource Efficiency**

* **High-Performance C++ Core:** Envoy is written in C++ and has been designed from the ground up
  for extreme performance, low latency, and a minimal memory/CPU footprint.
* **Reduced Overhead:** Compared to a JVM-based solution like the Micronaut gateway, Envoy consumes
  significantly fewer resources, which is a critical advantage in a containerized environment where
  pods are often resource-constrained. This translates to lower operational costs and higher density
  of services per node.

4. **Advanced Traffic Management and Observability**

* **Rich Feature Set:** Envoy provides a comprehensive suite of advanced traffic management features
  out-of-the-box, including:
  * **gRPC and HTTP/2 Support:** Native support for routing and load-balancing gRPC traffic, which
  is central to the new Go architecture.
  * **Resilience:** Sophisticated circuit breaking, timeouts, and retry policies.
  * **Deployment Strategies:** Fine-grained traffic shifting for canary releases, blue-green
  deployments, and A/B testing.
  * **Security:** Advanced TLS termination and configuration.
* **Unmatched Observability:** Envoy emits highly detailed statistics, logs, and distributed traces
  for every request, integrating seamlessly with tools like Prometheus (metrics) and Jaeger (
  tracing), which are standards in the Kubernetes ecosystem. This provides deep insight into system
  behavior without requiring any instrumentation in the Go services themselves.

5. **Configuration and Automation**

* **Declarative & Dynamic:** Envoy's configuration can be managed declaratively and updated
  dynamically via APIs without requiring restarts or downtime, which is essential for a CI/CD-driven
  environment. When used with a Kubernetes Ingress Controller, this configuration is managed through
  simple YAML files.
* **Protocol-Agnostic:** Envoy can handle and route any TCP or UDP-based protocol, making it
  versatile enough to manage not only HTTP and gRPC but also database connections or other custom
  protocols if needed.

This approach transforms the agent-portal-gateway from a custom application component into a
standardized infrastructure component, aligning with Kubernetes best practices and cloud-native
principles while providing superior performance and operational capabilities.

</details>

**2. auth-service**

- **Current**: Micronaut Security with Micronaut Data JPA for persistence.
- **Migration**: A native gRPC service handling JWT token management, using GORM for persistence,
  with an HTTP interface exposed via `grpc-gateway`.
- **Key Changes**:
  - Replace Micronaut Security with the `golang-jwt` library for token issuance and validation.
  - Replace Micronaut Data JPA with GORM for database operations against PostgreSQL.
  - Expose RESTful endpoints for login and token validation to external clients using `grpc-gateway`.

**3. chat-service**

- **Current**: Micronaut with WebSocket support and Micronaut Data JPA.
- **Migration**: A gRPC service that uses `gorilla/websocket` to manage client connections and GORM
  for persistence.
- **Key Changes**:
  - Use gRPC streaming for real-time message exchange between internal services.
  - Employ a WebSocket gateway using `gorilla/websocket` that translates client messages to and from
  the internal gRPC streams.
  - Replace Micronaut Data JPA with GORM for storing chat history and user data.

**4. dashboard-service**

- **Current**: Micronaut with Micronaut Data JPA and an Elasticsearch client.
- **Migration**: A gRPC service that uses GORM for relational data and a native Go Elasticsearch
  client for analytics, exposing data via `grpc-gateway`.
- **Key Changes**:
  - Replace Micronaut HTTP controllers with gRPC service definitions.
  - Use GORM for managing dashboard configurations and user preferences in PostgreSQL.
  - Integrate the `olivere/elastic` client for querying analytical data from Elasticsearch.

**5. document-service**

- **Current**: Micronaut with Micronaut Data JPA and local file system storage.
- **Migration**: A gRPC service that uses GORM for metadata persistence and MinIO for object
  storage, with `grpc-gateway` for external access.
- **Key Changes**:
  - Replace file system storage with the MinIO Go SDK for a scalable, S3-compatible solution.
  - Use GORM to manage document metadata in PostgreSQL.
  - Implement gRPC streaming for efficient handling of large file uploads and downloads.

**6. policy-service & payment-service**

- **Current**: Standard Micronaut services with Micronaut Data JPA.
- **Migration**: Standard gRPC services with GORM for PostgreSQL persistence and `grpc-gateway` for
  external API exposure.
- **Key Changes**:
  - Convert RESTful controller logic to gRPC service methods.
  - Replace Micronaut Data JPA repositories with GORM models and queries.
  - Use Protobuf for API contracts, enabling strong typing and validation.

**7. pricing-service**

- **Current**: Micronaut service executing pricing logic from file-based scripts.
- **Migration**: A lightweight, internal-only gRPC service that acts as a client to a Tarantool
  in-memory database where pricing logic is stored and executed as Lua stored procedures.
- **Key Changes**:
  - Eliminate file I/O by migrating pricing rules into Tarantool.
  - The Go service becomes a thin wrapper, forwarding pricing requests to Tarantool via the
  `go-tarantool` connector.
  - This service will not be exposed externally via HTTP.

**8. product-service**

- **Current**: Micronaut service using a MongoDB database.
- **Migration**: A gRPC service leveraging PostgreSQL with JSONB columns for product data, managed
  by GORM, and exposed via `grpc-gateway`.
- **Key Changes**:
   - Migrate product data from MongoDB to a PostgreSQL JSONB column to consolidate database
     technologies.
   - Use GORM's native JSONB support to query and manipulate semi-structured product data.
   - This approach combines the flexibility of a document database with the power of a relational
     database.

**9. policy-search-service**

- **Current**: Micronaut service providing search capabilities over Elasticsearch.
- **Migration**: An internal-only gRPC service that uses the `olivere/elastic` client to interface
  with Elasticsearch.
- **Key Changes**:
   - Convert search APIs from REST to gRPC methods.
   - Use gRPC streaming to handle large search result sets efficiently.
   - This service will only be accessible internally via gRPC.

#### Architecture Pattern Migrations

| Pattern                         | Current (Java/Micronaut)                    | Proposed (Go)                                                                                                                                   |
|---------------------------------|---------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------|
| **Inter-service Communication** | Micronaut HTTP Client (REST, JSON)          | Direct service-to-service gRPC calls with `grpc-go`                                                                                             |
| **External API Exposure**       | Micronaut HTTP Controllers                  | `grpc-gateway` to auto-generate a reverse-proxy server                                                                                          |
| **ORM / Data Access**           | Micronaut Data JPA (Hibernate)              | [GORM](https://gorm.io/) for PostgreSQL interaction                                                                                             |
| **Dependency Injection**        | Micronaut DI (Annotations, JSR-330)         | [Wire](https://github.com/google/wire) for compile-time dependency injection                                                                    |
| **Message Processing**          | Micronaut Kafka with JSON serialization     | [Sarama](https://github.com/Shopify/sarama) or [kafka-go](https://github.com/segmentio/kafka-go) with Avro serialization for schema enforcement |
| **Validation**                  | Micronaut Validation (Annotations, JSR-303) | [protoc-gen-validate](https://github.com/envoyproxy/protoc-gen-validate) for Protobuf-based validation                                          |
| **Configuration**               | Micronaut Configuration (YAML, Properties)  | [Viper](https://github.com/spf13/viper) for handling configuration from files, env vars, etc.                                                   |
| **Command/Query Bus**           | Custom Java implementation                  | Go interfaces to define command/query contracts, with handlers implemented using GORM for persistence                                           |

## System Observability

TODO

## Migration Strategy

TODO

Other Considerations
